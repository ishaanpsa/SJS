<!doctype html>
<html lang="pa" dir="ltr">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Sarbloh Japji Sahib</title>

<!-- Favicons -->
<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32.png">
<link rel="icon" type="image/png" sizes="64x64" href="favicons/favicon-64.png">
<link rel="icon" type="image/png" sizes="192x192" href="favicons/favicon-192.png">
<link rel="apple-touch-icon" sizes="180x180" href="favicons/favicon-180.png">
<meta name="theme-color" content="#0b234a">

<style>
  :root{ --maxw:1000px; --muted:#94a3b8; --border:#0a2a66; --blue:#0b234a; --btn:#173b8c; }
  body{ margin:0; font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#e5e7eb; background:#0b1220; }
  main{ margin:0 auto; max-width:var(--maxw); padding:12px; padding-bottom:84px; }

  .stage{
    position:relative;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:calc(100svh - 132px);
  }

  img{
    display:block;
    max-width:95%;
    height:auto;
    border:1px solid #1e293b;
    border-radius:.6rem;
    background:#fff;
    margin-left:auto;
    margin-right:auto;
    box-shadow:0 4px 16px rgba(0,0,0,.4);
  }

  /* On small screens, enlarge for readability */
  @media (max-width: 600px) {
    img {
      max-width:115%;
      transform:scale(1.15);
      transform-origin:center top;
    }
  }

  .fit-h img{
    width:auto;
    height:calc(100svh - 132px);
    max-height:calc(100svh - 132px);
  }

  /* Slim bottom bar */
  .nav{
    position:fixed; left:0; right:0; bottom:0; z-index:10;
    display:flex; align-items:center; justify-content:space-between;
    height:48px; padding:0 12px env(safe-area-inset-bottom);
    border-top:1px solid var(--border);
    background: var(--blue); color:#fff;
  }
  .nav small{ color:#fff; font-weight:700; }
  .btn{
    padding:.35rem .6rem; border:1px solid #2a478e; border-radius:.5rem;
    background: var(--btn); color:#fff; font:inherit; cursor:pointer;
  }
  .btn:disabled{ opacity:.6; cursor:not-allowed }

  /* Floating arrows */
  .fab{
    position:fixed; bottom:60px; width:42px; height:42px; border-radius:999px;
    display:grid; place-items:center; border:1px solid #334155;
    background:#0b234acc; color:#fff; backdrop-filter:saturate(1.1) blur(4px); cursor:pointer;
  }
  .fab-left{ left:10px; } .fab-right{ right:10px; }

  .tip{ color:#94a3b8; font-size:.9rem; margin:4px 0 0 2px; }
  @media (max-width:560px){ body{font-size:15px} }
</style>
<body>
  <main>
    <div class="stage" id="stage">
      <img id="pageImg" alt="PDF page 1" loading="eager">
    </div>
    <div id="err" class="tip" style="display:none"></div>
    <div class="tip">Swipe ◀/▶, or tap arrows. Use “Fit” for tall pages.</div>
  </main>

  <!-- floating arrows -->
  <button class="fab fab-left"  id="prevFab"  aria-label="Previous page">◀</button>
  <button class="fab fab-right" id="nextFab"  aria-label="Next page">▶</button>

  <!-- slim bottom bar -->
  <div class="nav">
    <small id="pageIndicator">Page 1 / 10</small>
    <button class="btn" id="fitToggle">Fit: Width</button>
  </div>

<script>
  const NUM_PAGES = 10;
  const BASE = "assets";
  const fname = n => `page-${String(n).padStart(3,"0")}.png`;
  const bust = `?v=${Date.now()}`;

  let idx = 0;
  const img  = document.getElementById('pageImg');
  const ind  = document.getElementById('pageIndicator');
  const err  = document.getElementById('err');
  const stage= document.getElementById('stage');
  const fitToggle = document.getElementById('fitToggle');
  const prevFab = document.getElementById('prevFab');
  const nextFab = document.getElementById('nextFab');

  const urlFor = n => `${BASE}/${fname(n)}${bust}`;
  const showErr = m => { err.style.display='block'; err.textContent=m; console.error(m); }
  const clearErr= () => { err.style.display='none'; err.textContent=''; }

  function update(){
    clearErr();
    const n = idx+1;
    img.src = urlFor(n);
    img.alt = `PDF page ${n}`;
    ind.textContent = `Page ${n} / ${NUM_PAGES}`;
    prevFab.disabled = (idx===0);
    nextFab.disabled = (idx===NUM_PAGES-1);
    location.hash = `#p${n}`;
  }

  img.addEventListener('error', ()=>{
    showErr(`Couldn't load: ${img.src.replace(location.origin,'')}. Check ${BASE}/${fname(idx+1)} (case-sensitive).`);
  });

  function prev(){ if(idx>0){ idx--; update(); } }
  function next(){ if(idx<NUM_PAGES-1){ idx++; update(); } }
  prevFab.addEventListener('click', prev);
  nextFab.addEventListener('click', next);
  window.addEventListener('keydown', e=>{
    if(e.key==='ArrowLeft')  prev();
    if(e.key==='ArrowRight') next();
  });

  // Fit toggle
  let fit='width';
  function applyFit(){
    if(fit==='height'){ stage.classList.add('fit-h');  fitToggle.textContent='Fit: Height'; }
    else              { stage.classList.remove('fit-h');fitToggle.textContent='Fit: Width'; }
  }
  fitToggle.addEventListener('click', ()=>{ fit = (fit==='width'?'height':'width'); applyFit(); });

  // swipe
  let sx=0, sy=0, moved=false; const TH=40;
  stage.addEventListener('touchstart', e=>{ const t=e.changedTouches[0]; sx=t.clientX; sy=t.clientY; moved=false; }, {passive:true});
  stage.addEventListener('touchmove', ()=>{ moved=true; }, {passive:true});
  stage.addEventListener('touchend', e=>{
    if(!moved) return;
    const t=e.changedTouches[0]; const dx=t.clientX-sx, dy=t.clientY-sy;
    if(Math.abs(dx)>Math.abs(dy) && Math.abs(dx)>TH){ dx<0 ? next() : prev(); }
  }, {passive:true});

  (function init(){
    const m = location.hash.match(/#p(\d+)/i);
    if(m){ idx = Math.min(Math.max(parseInt(m[1],10)-1,0), NUM_PAGES-1); }
    applyFit();
    update();
  })();
</script>
</body>
</html>
