<!doctype html>
<html lang="pa" dir="ltr">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>SJS — Compact Mobile Viewer</title>
<style>
  :root{ --maxw:1000px; --muted:#6b7280; --border:#e5e7eb; }
  body{ margin:0; font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#111; background:#fff; }
  main{ margin:0 auto; max-width:var(--maxw); padding:12px; padding-bottom:84px; }
  .stage{ position:relative; display:flex; justify-content:center; }
  img{ display:block; max-width:100%; height:auto; border:1px solid var(--border); border-radius:.6rem; background:#fff; }
  .fit-h img{ width:auto; height:calc(100svh - 132px); max-height:calc(100svh - 132px); }

  /* Slim bottom bar */
  .nav{ position:fixed; left:0; right:0; bottom:0; z-index:10;
        display:flex; align-items:center; justify-content:space-between; gap:.5rem;
        height:48px; padding:0 10px env(safe-area-inset-bottom);
        border-top:1px solid var(--border); background:#fffccf; }
  .nav small{ color:#111; font-weight:600; }
  .nav .right{ display:flex; gap:.4rem; align-items:center; }
  .btn{ padding:.35rem .6rem; border:1px solid var(--border); border-radius:.5rem; background:#f8fafc; font:inherit; cursor:pointer; }
  .btn:disabled{ opacity:.5; cursor:not-allowed }

  /* Floating tiny arrows */
  .fab{ position:fixed; bottom:60px; width:42px; height:42px; border-radius:999px;
        display:grid; place-items:center; border:1px solid var(--border);
        background:#ffffffcc; backdrop-filter:saturate(1.1) blur(4px); cursor:pointer; }
  .fab-left{ left:10px; } .fab-right{ right:10px; }
  .tip{ color:var(--muted); font-size:.9rem; margin:4px 0 0 2px; }

  @media (max-width:560px){ body{font-size:15px} }
</style>
<body>
  <main>
    <div class="stage" id="stage">
      <img id="pageImg" alt="PDF page 1" loading="eager">
    </div>
    <div id="err" class="tip" style="display:none"></div>
    <div class="tip">Swipe ◀/▶, tap arrows, or use Fit for tall pages.</div>
  </main>

  <!-- floating arrows -->
  <button class="fab fab-left"  id="prevFab"  aria-label="Previous page">◀</button>
  <button class="fab fab-right" id="nextFab"  aria-label="Next page">▶</button>

  <!-- slim bottom bar -->
  <div class="nav">
    <small id="pageIndicator">Page 1 / 10</small>
    <div class="right">
      <button class="btn" id="fitToggle">Fit: Width</button>
      <button class="btn" id="jumpBtn" title="Jump to page">Jump</button>
    </div>
  </div>

<script>
  // ---- config ----
  const NUM_PAGES = 10;
  const BASE = "assets";
  const fname = n => `page-${String(n).padStart(3,"0")}.png`;
  const bust = `?v=${Date.now()}`;

  // ---- els ----
  let idx = 0;
  const img  = document.getElementById('pageImg');
  const ind  = document.getElementById('pageIndicator');
  const err  = document.getElementById('err');
  const stage= document.getElementById('stage');
  const fitToggle = document.getElementById('fitToggle');
  const prevFab = document.getElementById('prevFab');
  const nextFab = document.getElementById('nextFab');

  // ---- helpers ----
  const urlFor = n => `${BASE}/${fname(n)}${bust}`;
  const showErr = m => { err.style.display='block'; err.textContent=m; console.error(m); }
  const clearErr= () => { err.style.display='none'; err.textContent=''; }

  function update(){
    clearErr();
    const n = idx+1;
    img.src = urlFor(n);
    img.alt = `PDF page ${n}`;
    ind.textContent = `Page ${n} / ${NUM_PAGES}`;
    prevFab.disabled = (idx===0);
    nextFab.disabled = (idx===NUM_PAGES-1);
    location.hash = `#p${n}`;
  }

  img.addEventListener('error', ()=>{
    showErr(`Couldn't load: ${img.src.replace(location.origin,'')}. Check ${BASE}/${fname(idx+1)} (case-sensitive).`);
  });

  // nav actions
  function prev(){ if(idx>0){ idx--; update(); } }
  function next(){ if(idx<NUM_PAGES-1){ idx++; update(); } }
  prevFab.addEventListener('click', prev);
  nextFab.addEventListener('click', next);
  window.addEventListener('keydown', e=>{
    if(e.key==='ArrowLeft')  prev();
    if(e.key==='ArrowRight') next();
  });

  // compact Jump (prompt)
  document.getElementById('jumpBtn').addEventListener('click', ()=>{
    const n = parseInt(prompt(`Jump to page (1–${NUM_PAGES})`, String(idx+1))||'',10);
    if(!isNaN(n) && n>=1 && n<=NUM_PAGES){ idx = n-1; update(); }
  });

  // Fit toggle
  let fit='width';
  function applyFit(){
    if(fit==='height'){ stage.classList.add('fit-h');  fitToggle.textContent='Fit: Height'; }
    else              { stage.classList.remove('fit-h');fitToggle.textContent='Fit: Width'; }
  }
  fitToggle.addEventListener('click', ()=>{ fit = (fit==='width'?'height':'width'); applyFit(); });

  // swipe
  let sx=0, sy=0, moved=false; const TH=40;
  stage.addEventListener('touchstart', e=>{ const t=e.changedTouches[0]; sx=t.clientX; sy=t.clientY; moved=false; }, {passive:true});
  stage.addEventListener('touchmove', ()=>{ moved=true; }, {passive:true});
  stage.addEventListener('touchend', e=>{
    if(!moved) return;
    const t=e.changedTouches[0]; const dx=t.clientX-sx, dy=t.clientY-sy;
    if(Math.abs(dx)>Math.abs(dy) && Math.abs(dx)>TH){ dx<0 ? next() : prev(); }
  }, {passive:true});

  // init
  (function init(){
    const m = location.hash.match(/#p(\d+)/i);
    if(m){ idx = Math.min(Math.max(parseInt(m[1],10)-1,0), NUM_PAGES-1); }
    applyFit();
    update();
  })();
</script>
</body>
</html>
